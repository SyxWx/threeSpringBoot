<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>websocket通讯tsp</title>
</head>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<script>
    let websocket = null;

    function openSocket() {
        //判断浏览器是否支持WebSocket
        if ('WebSocket' in window) {
            //websocket = new WebSocket("ws://localhost:8080/ws/magic/tsp/getList/" + $("#customerId").val());
            websocket = new WebSocket("ws://localhost:8080/ws/magic/tsp/getList/" + $("#customerId").val());

            //开启websocket连接，指定连接成功后的回调函数
            websocket.onopen = function () {
                console.log("websocket open");
            };

            //添加回调函数
            websocket.addEventListener('open',function (event) {
                console.log("open callback：" + event.data);
            });

            //获得消息
            websocket.onmessage = function (event) {
                console.log(event.data);
                setMessageInnerHTML(event.data)
            };

            //关闭事件
            websocket.onclose = function () {
                console.log("websocket已关闭");
            };

            //发生了错误事件
            websocket.onerror = function () {
                console.log("websocket发生了错误");
            }
        } else {
            console.log("您的浏览器不支持WebSocket");
        }
    }



    //将消息显示在网页上
    function setMessageInnerHTML(innerHTML) {
        document.getElementById('message').innerHTML += innerHTML + '<br/>';
    }

</script>
<body>
【TSP数据接收】
<div>
    <input id="customerId" name="customerId" type="text"/>
    <a onclick="openSocket()"><input  name="customerId" type="button" value = '开启socket'/></a>
</div>
<div id="message"></div>
</body>
</html>